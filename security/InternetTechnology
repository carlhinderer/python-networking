-----------------------------------------------------------------------
|  LAYER 1 - THE LINK LAYER                                           |
-----------------------------------------------------------------------

- From Store and Forward to Routers

    - In order to keep costs low and connections geographically short, data will be
        forwarded through several routers.

    - Getting across the country usually takes about 10 hops.

    - Network designers continually add and remove links to 'tune' their networks.


- Layered Network Model

    - A layered approach allows the problem of designing networks to be broken up into parts.

    - This is known as the TCP/IP protocol suite.  The 7-layer OSI model was also used.

        Application Layer    [Web, Email, File Transfer]
        Transport Layer      [Reliable Connections]
        Internetwork Layer   [Simple, Unreliable]
        Link Layer           [Ethernet, Wifi]


- Internet Standards

    - The standards for all of the Internet protocols are developed by the IETF
    - Standards are called RFCs (Requests for Comments)


- Layered Architecture

    - The Physical and Internet layers are like trucks and trains - they haul stuff to the
        correct loading docks, and it takes multiple steps.

    - The Transport layer checks to see if the trucks made it and send the stuff again if
        necessary.


                          Stack Connections
        ---------------------------------------------------------

            Application                       Application
                 |                             ^
                 v                             |
             Transport                        Transport
                 |                             ^
                 v                             |
              Internet   Internet Internet    Internet
                 |         ^   |    ^  |       ^
                 v         |   v    |  v       |
                Link        Link   Link       Link
                 |         ^   |    ^  |       ^
                 |         |   v    |  v       |
                   Ethernet    Fiber    Ethernet



- The Link Layer (aka The Physical Layer)

    - As your data crosses the country, it may use a different physical medium for each hop.
    - The medium could be Wire, Wireless, Fiber Optic, etc.
    - The link is one 'hop' - Is it up or down?  Is it connected?
    - Has a very narrow focus, no view of the whole internet
    - Just gets data across the wire from one computer to another


- Problems Solved by the Link Layer

    - How does the data get pushed onto a link?
    - How is the link shared?

    - Common Link Technologies
        - Ethernet
        - WiFi
        - Cable Modem
        - DSL
        - Satellite
        - Optical


- Link Layer Addresses

    - Many physical layer devices have addresses built into them by the manufacturer
        (ie Ethernet and WiFi)

    - Physical addresses allow systems to identify themselves on the ends of a single link
        (in case they are shared, for instance on a hub)

    - Physical addresses go no further than one link

    - Sometimes links like WiFi and wired Ethernet are shared with multiple computers


- Sharing Nicely - Avoiding Chaos

    - CSMA/CD = Carrier Sense Multiple Access with Collision Detection

    - To avoid garbled messages, systems must observer "rules" (protocols)

    - Ethernet rules are simple

        1. Wait for silence
        2. Begin transmitting data
        3. Listen for your own data
        4. If you cannot hear your own data clearly, assume a collision, wait and try again
        5. Each system waits a different time to avoid "too much politeness"


- Ethernet

    - Invented by Robert Metcalf at Xerox PARC (1973)
    - The first Local-Area-Network
    - Connected PCs to laser printer (the first laser printer)
    - Inspired by an earlier wireless network called 'Aloha' at University of Hawaii
    - Computers connected to a single coaxial cable using vampire taps





-----------------------------------------------------------------------
|  LAYER 2 - THE INTERNET PROTOCOL                                    |
-----------------------------------------------------------------------

- Internet Protocol Layer

    - Goal: Gets your data from this computer to other computer halfway around the
        world.  

    - Each router knows about nearby routers.

    - IP is best effort.  It's OK to drop data if things go bad.


- IP Addresses

    - The IP address is the worldwide number which is associated with one particular 
        workstation or server

    - Every system which will send packets directly out across the Internet must have 
        a unique IP address

    - IP addresses are based on where station is connected

    - IP addresses are not controlled by a single organization - address ranges are 
        assigned

    - They are like phone numbers – they get reorganized once in a great while


- IP Address Format

    - Four numbers with dots - each number 1-255 (32 bits)

    - Kind of like phone numbers with an “area code”

    - The prefix of the address is “which network”

    - While the data is traversing the Internet - all that matters is the network 
        number

        141.211.144.188
        141.211.*.*


- Router Tables

    - No single router knows the whole network, just which way to send data to get it
        'closer'.

    - Router tables are lists of where to send packets, based on:
        - destination network address
        - bandwidth on adjacent links
        - traffic on adjacent links
        - state of neighbor nodes (up or not)


- IP is Simple

    - Local network connects to 100s of servers
    - Must support thousands of network connections, billions of bytes of data per second
    - Thousands of user systems on each segment


- DHCP

    - The Dynamic Host Configuration Protocol

    - When a host joins the network, it asks for the router

    - Router returns an IP address that can be used for communications


- Non-Routable Addresses

    - A typical home router does NAT (Network Address Translation)

    - Your ISP gives your home router a real global routable address

    - Your router gives out local addresses in a special range (192.168.*.*)

    - The router maps remote addresses for each connection you make from within 
        your home network


- Peering into the Internet

    - Most systems have a command that will reveal the route taken across the internet 
        (traceroute on Mac and tracert on Windows)

        $ traceroute www.stanford.edu

    - Each IP packet has a field called “Time to Live” - TTL

    - The TTL is used to deal with loops in the network - normally if routers got confused 
        and ended up with a loop - the network would clog up rapidly.


- How Traceroute Works

    - Normal packets are sent with a Time to Live (TTL) of 255 hops

    - Trace route sends a packet with TTL=1, TTL=2, ...

    - So each packet gets part-way there and then gets dropped and traceroute gets a 
        notification of where the drop happens

    - This builds a map of the nodes that a packet visits when crossing the Internet.


- The Perfect is the Enemy of the Good

    - IP Does: Best effort to get data across bunch of hops from one network to another 
        network

    - IP Does Not: Guarantee delivery - if things go bad - the data can vanish

    - Best effort to keep track of the good and bad paths for traffic - tries to pick better 
        paths when possible

    - This makes it fast and scalable to very large networks - and ultimately “reliable” 
        because it does not try to do too much


- Vint Cerf

    - Instrumental in the design and development of the ARPANET

    - Vint was a graduate student as the notions of packet-switching were emerging across 
        academia


- Domain Name System

    - Numeric addresses like 141.211.63.45 are great for Internet routers but lousy for 
        people

    - Each campus ends up with a lot of networks (141.211.*.*, 65.43.21.*)

    - Sometimes (rarely) the IP address numbers get reorganized

    - When servers physically move they need new IP addresses


- DNS: Internet Address Book

    - The Domain Name System is a big fast distributed database of Internet names to 
        Internet “phone numbers”

    - IP Addresses reflect technical “geography”
        141.211.63.44 - read left to right like a phone number

    - Domain names reflect organizational structure
        www.si.umich.edu - read right to left like postal address
        2455 North Quad, Ann Arbor, MI, USA, Earth


- Domain Name Space

    - / root
        > .org
        > .edu
        > .com
        > .nl





-----------------------------------------------------------------------
|  LAYER 3 - TCP                                                      |
-----------------------------------------------------------------------





-----------------------------------------------------------------------
|  LAYER 4 - THE APPLICATION LAYER                                    |
-----------------------------------------------------------------------